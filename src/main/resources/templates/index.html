<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>Employee Management System</title>

    <!-- Bootstrap imported (4.3.1 -> old one)-->
<!--    <link rel="stylesheet"-->
<!--          href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"-->
<!--          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"-->
<!--          crossorigin="anonymous">-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
          crossorigin="anonymous">
</head>

<body>
<!-- NavBar (Completed) -->
<nav class="navbar navbar-expand-md navbar-light">
    <div class="container">
        <a class="navbar-brand" href="#" th:href="@{/}">
            <img th:src="@{/logo.png}" alt="company-logo"
                 class="d-inline-block align-top" width="30" height="30"/> Employee Management System</a>
        <!--Logout href (Defined action in SecurityConfiguration)-->
        <a type="button" class="btn btn-danger" sec:authorize="isAuthenticated()" th:href="@{/logout}">Logout</a>
    </div>
</nav>

<div class="container my-2">
    <h1>Employees List</h1>

    <!-- "Welcome User", with dependency(thymeleaf-extras-springsecurity5) -->
    <div class="alert alert-primary d-flex align-items-center" role="alert">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
        </svg>
        <div>&nbsp Welcome <span sec:authentication="principal.username">User</span></div>
    </div>

    <!-- Add a new employee -->
    <a th:href="@{/showNewEmployeeForm}" class="btn btn-primary btn-sm mb-3"> Add Employee</a>

    <!-- Employees Table-->
    <table border="1" class="table tale table-striped table-responsive-md">
        <thead>
        <tr> <!-- 1st Row (First Name, Last Name, Email, Actions)-->
            <!-- Hidden hyperlinks, for toggle action, when clicking, sorting in asc/desc direction-->
            <th><a th:href="@{'/page/' + ${currentPage} + '?sortField=firstName&sortDir=' + ${reverseSortDir}}">
                Employee First Name</a></th>
            <th><a th:href="@{'/page/' + ${currentPage} + '?sortField=lastName&sortDir=' + ${reverseSortDir}}">
                Employee Last Name</a></th>
            <th><a th:href="@{'/page/' + ${currentPage} + '?sortField=email&sortDir=' + ${reverseSortDir}}">
                Employee Email</a></th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody> <!-- Each Table Row Content -->
        <tr th:each="employee : ${listEmployees}"> <!-- Iterating employees with listEmployees(Controller Class) -->
            <td th:text="${employee.firstName}"></td>
            <td th:text="${employee.lastName}"></td>
            <td th:text="${employee.email}"></td>
            <!-- Update/Delete Button  -->
            <!-- Binding employee id to thymeleaf, for employee actions -->
            <td><a th:href="@{/showFormForUpdate/{id}(id=${employee.id})}" class="btn btn-primary">Update</a>
                <!-- Previous version, with <a> instead of <button>-->
<!--                <a th:href="@{/deleteEmployee/{id}(id=${employee.id})}" class="btn btn-danger">Delete</a>-->

                <!-- TESTING MODAL POPUP AFTER CLICKING DELETE -->
                <button th:href="@{/deleteEmployee/{id}(id=${employee.id})}" type="button" class="btn btn-danger" data-toggle="modal" data-target="#exampleModal">Delete</button>

                <!-- Modal -->
                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <!-- Header -->
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <!-- Body -->
                            <div class="modal-body">
                                This is a test
                            </div>
                            <!-- Footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>

            </td>
        </tr>
        </tbody>
    </table>

    <!-- Pagination (Pagination only appears if totalPages != 0)-->
    <nav aria-label="Page Navigation" class="display-inline" th:if="${totalPages != 0}">
        <ul class="pagination justify-content-center">
            <!-- Previous -->
            <li th:class="${currentPage > 1 ? 'page-item' : 'page-item disabled'}">
                <a class="page-link"
                   th:href="@{'/page/' + ${currentPage - 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Previous
                </a>
            </li>
            <!-- Show all pages -->
            <!-- Must configure, User chooses number of page items(EmployeeController/findPaginated/pageSize -> Configure in UI a @PathVariable) -->
            <li th:each="i : ${#numbers.sequence(1, totalPages)}"
                th:class="${currentPage != i ? 'page-item' : 'page-item active'}">
                <a class="page-link"
                   th:href="@{'/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">[[${i}]]</a>
            </li>
            <!-- Next -->
            <li th:class="${currentPage < totalPages ? 'page-item' : 'page-item disabled'}">
                <a class="page-link"
                   th:href="@{'/page/' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Next</a>
            </li>
        </ul>
    </nav>

</div>
</body>

</html>